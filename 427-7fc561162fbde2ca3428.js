(window.webpackJsonp=window.webpackJsonp||[]).push([[427],{3147:function(e,n,s){"use strict";s.r(n);var a=s(0),t=s.n(a),o=s(4),r=s.n(o),i=s(90),p=r.a.bind({"orion-fusion-theme":"marked-module__orion-fusion-theme___2aD2P",marked:"marked-module__marked___1RgKN"});n.default=function(){var e=t.a.useContext(i.ThemeContext);return t.a.createElement("div",{dir:"ltr",className:p("marked",e.className),dangerouslySetInnerHTML:{__html:'<h1 id="terra-functional-testing-version-1-upgrade-guide"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#terra-functional-testing-version-1-upgrade-guide"><span class="icon icon-link" /></a>Terra Functional Testing - Version 1 Upgrade Guide</h1><p>We&#39;re excited to announce the release of @cerner/terra-functional-testing which will be replacing the automation testing responsibilities of terra-toolkit. We&#39;ve made some changes and gave our testing infrastructure a much needed upgrade. This document will outline the major changes and provide useful tips for upgrading from <code>terra-toolkit</code> to <code>@cerner/terra-functional-testing</code> v1.</p>\n<h2 id="introduction"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#introduction"><span class="icon icon-link" /></a>Introduction</h2><p>Since terra-toolkit was originally released in 2017 many new features have been added to create an all-in-one development toolkit. These new features introduced responsibilities for the development site, webpack, jest, reporting, and automation testing. Bundling all these responsibilities into single package has made it difficult to introduce new changes. With the upgrade to WebDriverIO v6 we decided to use this as an opportunity for restructuring our development tools.</p>\n<h2 id="new-package-structure"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#new-package-structure"><span class="icon icon-link" /></a>New Package Structure</h2><p>The <a href="https://github.com/cerner/terra-toolkit">terra-toolkit</a> repository has been converted into a <a href="https://github.com/lerna/lerna">lerna monorepo</a> that contains independent packages for each of our development tools. The <a href="https://www.npmjs.com/package/terra-toolkit">terra-toolkit development package</a> has been moved into the <a href="https://github.com/cerner/terra-toolkit-boneyard">terra-toolkit-boneyard</a> repository and will receive minor updates and bug fixes as teams begin the transition to terra-functional-testing.</p>\n<p>Moving forward, development responsibilities have been separated out into individual packages that encapsulate specific functionality. As we transition packages into the terra-toolkit monorepo each package will be scoped under the <a href="https://www.npmjs.com/org/cerner">@cerner</a> NPM organization. For example, automation testing has been moved into @cerner/terra-functional-testing and webpack concerns have been moved into <a href="https://engineering.cerner.com/terra-ui/dev_tools/cerner/webpack-config-terra/about">@cerner/webpack-config-terra</a>.</p>\n<h2 id="breaking-changes"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#breaking-changes"><span class="icon icon-link" /></a>Breaking Changes</h2><p>There are quite a few breaking changes with this upgrade. Most notably are the breaking changes from WebDriverIO v4 to v6. We&#39;re jumping two major versions as part of this upgrade to get our testing infrastructure a much needed upgrade. Many of the browser command APIs have changed to align more consistently. As part of this upgrade teams should expect to update many of their tests. We&#39;ll outline a few examples throughout this guide.</p>\n<h3 id="webdriverio-v4-to-v6"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#webdriverio-v4-to-v6"><span class="icon icon-link" /></a>WebDriverIO v4 to v6</h3><p>The most notable breaking changes are the breaking changes from WebDriverIO v4 to WebDriverIO v6. We&#39;ll outline a few of the most common API changes we encountered ourselves as we uplifted our own repositories. A complete list of the breaking changes can be found here:</p>\n<ul>\n<li><a href="https://github.com/webdriverio/webdriverio/blob/v5.0.0/CHANGELOG.md#boom-breaking-change">WebDriverIO v5 Breaking Changes</a></li>\n<li><a href="https://github.com/webdriverio/webdriverio/blob/d1f3da652f287d297bd6b13f49194d58599dacd0/CHANGELOG.md#boom-breaking-change">WebDriverIO v6 Breaking Changes</a></li>\n</ul>\n<p>Commands used during testing have been updated to create a clear distinction between commands acting on the browser/client and commands acting on an element.</p>\n<p>For example, in WebDriverIO v4 a click interaction could be called on the browser by passing it a selector, but in v5 and above the action is called on the element instance. When upgrading each of these commands must be updated to the new syntax.</p>\n<pre><code class="codeblock language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> browser.click(\'#element\'); // Old v4 click. This has been removed.\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> $(\'#element\').click(); // New v6 click. The action is called on the element instance.</span></span></code></pre>\n<p>Here are a few of the most common scenarios we encountered:</p>\n<pre><code class="codeblock language-diff">// Clicks\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> browser.click(\'#element\');\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> $(\'#element\').click();\n</span></span>\n// Set Value\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> browser.setValue(\'input\', \'value\');\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> $(\'input\').setValue(\'value\');\n</span></span>\n// Add Value\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> browser.addValue(\'input\', \'value\');\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> $(\'input\').addValue(\'value\');\n</span></span>\n// Wait For Visible\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> browser.waitForVisible(\'#element\');\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> $(\'#element\').waitForDisplayed();\n</span></span>\n// Move To\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> browser.moveToObject(\'#element\', 0, 10);\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> $(\'#element\').moveTo({ xOffset: 0, yOffset: 10 });</span></span></code></pre>\n<h3 id="dropping-support-for-node-8"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#dropping-support-for-node-8"><span class="icon icon-link" /></a>Dropping Support For Node 8</h3><p>We&#39;re dropping support for node 8 as part of the transition to terra-functional-testing. Node 8 reached <a href="https://github.com/nodejs/Release/blob/master/README.md#end-of-life-releases">end of life status</a> December 31st, 2019. Teams still on node 8 will need to upgrade to node 10.</p>\n<p>We plan to start upgrading our node version on a more routine cadence following this transition. Our range of node version support is restricted by our transitive dependency on <a href="https://github.com/laverdet/node-fibers">fibers</a> which is necessary for running our WebDriverIO testing environment <a href="https://v6.webdriver.io/docs/sync-vs-async.html">synchronously</a>.</p>\n<h3 id="assertion-framework"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#assertion-framework"><span class="icon icon-link" /></a>Assertion Framework</h3><p>We&#39;ve removed the <a href="https://www.chaijs.com/">chai assertion framework</a> and opted into using the built in <a href="https://v6.webdriver.io/docs/assertion.html">assertion library</a> that ships with WebDriverIO. This new assertion framework closely resembles the testing environment most of us are used to in Jest, because it is <a href="https://jestjs.io/docs/en/expect">Jest&#39;s expect library</a>. This should help align testing between Jest and WebDriverIO.</p>\n<p>A few common changes look something like this:</p>\n<pre><code class="codeblock language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> expect(true).to.be.true; // Chai assertion\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> expect(true).toBe(true); // Expect/Jest assertion.\n</span></span>\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> expect(true).to.be.false; // Chai assertion\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> expect(true).toBe(false); // Expect/Jest assertion.\n</span></span>\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> expect(1).to.equal(1); // Chai assertion\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> expect(1).toEqual(1); // Expect/Jest assertion.</span></span></code></pre>\n<p>WebDriverIO provides a collection of <a href="https://v6.webdriver.io/docs/api/expect.html">matchers</a> that can be used for assertions in your tests.</p>\n<h3 id="terra-commands"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#terra-commands"><span class="icon icon-link" /></a>Terra Commands</h3><p>The <code>Terra.it</code> commands have been removed. We noticed they encouraged anti-patterns while writing tests and made testing more confusing.</p>\n<p>These commands have been removed:</p>\n<ul>\n<li>Terra.it.validatesElement</li>\n<li>Terra.it.isAccessible</li>\n<li>Terra.it.matchesScreenshot</li>\n</ul>\n<p>These commands can still be used but have had some changes:</p>\n<ul>\n<li>Terra.validates.accessibility</li>\n<li>Terra.validates.element</li>\n<li>Terra.validates.screenshot</li>\n</ul>\n<p>The validates screenshot and validates element commands now require a screenshot name.</p>\n<pre><code class="codeblock language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'should click and validate the element\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">\'#element\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  Terra<span class="token punctuation">.</span>validates<span class="token punctuation">.</span><span class="token function">element</span><span class="token punctuation">(</span><span class="token string">\'screenshot name\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  A unique screenshot name must be provided or the command will throw an error.</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>The <code>viewports</code> option has been removed from <code>Terra.validates.screenshot</code>. The viewport option array created additional viewport permutations within other viewport permutations. To more consistently align viewport testing the option was removed. To specify an array of viewports use the <code>Terra.describeViewports</code> helper.</p>\n<pre><code class="codeblock language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> Terra.describeViewports(\'Terra.validates\', [\'tiny\', \'small\'], () => {\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  it(\'should click and validate the element\', () => {\n</span><span class="token prefix unchanged"> </span><span class="token line">    $(\'#element\').click();\n</span></span>\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     Terra.validates.screenshot(\'screenshot name\', { viewports: [\'tiny\', \'small\'] });\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     Terra.validates.screenshot(\'screenshot name\');\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  });\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> });</span></span></code></pre>\n<h3 id="screenshots"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#screenshots"><span class="icon icon-link" /></a>Screenshots</h3><p>We&#39;ve forked and taken ownership of the visual regression service to give us better control of making changes when necessary. Over time we&#39;ll be working to resolve common errors encountered with the visual regression service. Such as the notorious x,y range error.</p>\n<p>For now though, there are a few breaking changes to the screenshot strategy that will require regenerating screenshots.</p>\n<ul>\n<li>Screenshot names are no longer auto-generated using the describe blocks.</li>\n<li>Screenshots now require a unique name be provided. No screenshots within the same spec file should be identical. Screenshots in other spec files are not affected.</li>\n<li>Screenshots will be scoped under a theme when written to file under _<em>snapshots_</em>.</li>\n</ul>\n<p>We&#39;ve removed the string concatenation of describe blocks to form a screenshot filename. Previously, the following example would generate a screenshot name of <code>block_1_block_2_screenshot_name</code>.</p>\n<pre><code class="codeblock language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'block 1\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'block 2\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'should generate a screenshot\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      Terra<span class="token punctuation">.</span>validates<span class="token punctuation">.</span><span class="token function">element</span><span class="token punctuation">(</span><span class="token string">\'screenshot name\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Previously screen generated as block_1_block_2_screenshot_name.</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>This was causing/forcing teams to modify their test structure to produce a meaningful screenshot name. A screenshot could be generated with a tremendously long filename and required sanitizing each of the block descriptions to remove special characters. Describe blocks should be used to describe and group tests together. They should not be introducing side effects to the generated screenshot name.</p>\n<p>Moving forward, a unique name must be provided for the screenshot. This should help shorten screenshot names, provide a meaningful name, and encourage developers to write tests semantically.</p>\n<pre><code class="codeblock language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'block 1\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">\'block 2\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'should generate a screenshot\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      Terra<span class="token punctuation">.</span>validates<span class="token punctuation">.</span><span class="token function">element</span><span class="token punctuation">(</span><span class="token string">\'unique screenshot name\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This will now generate a screenshot named unique_screenshot_name.</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>As theming has become more prevalent in our ecosystem screenshots are now always written into a theme directory in _<em>snapshots_</em>. If your application does not explicitly use a theme the screenshots will output under the default <code>terra-default-theme</code> directory. This change will require regenerating screenshots to move them into the appropriate theme directory.</p>\n<pre><code>├── __snapshots__\n│   ├── reference\n│   │   ├── clinical-lowlight-theme\n│   │   │   └── en\n│   │   │       └── chrome_huge\n│   │   │           └── example-spec\n│   │   │               ├── screenshot-1.png\n│   │   │               └── screenshot-2.png\n│   │   ├── orion-fusion-theme\n│   │   │   └── en\n│   │   │       └── chrome_huge\n│   │   │           └── example-spec\n│   │   │               ├── screenshot-1.png\n│   │   │               └── screenshot-2.png\n│   │   └── terra-default-theme\n│   │       └── en\n│   │           └── chrome_huge\n│   │               └── example-spec\n│   │                   ├── screenshot-1.png\n│   │                   └── screenshot-2.png</code></pre><h3 id="timezone"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#timezone"><span class="icon icon-link" /></a>Timezone</h3><p>The <code>American/Chicago</code> timezone has been removed from the docker images. The timezone will default to the timezone provided by the docker image. This will align the selenium grid and local docker images to the same timezone.</p>\n<h3 id="accessibility-testing"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#accessibility-testing"><span class="icon icon-link" /></a>Accessibility Testing</h3><p>The dependency on <a href="https://github.com/dequelabs/axe-core">axe-core</a> has been upgraded from v3.5.3 to v4.0.2. There were no new rules introduced, but previous rules had fixes added that might start detecting accessibility violations after the upgrade that were not previously being detected.</p>\n<p>Check out the <a href="https://github.com/dequelabs/axe-core/releases">release notes</a> for more detail information about the changes.</p>\n<h3 id="default-selector"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#default-selector"><span class="icon icon-link" /></a>Default Selector</h3><p>The default selector has been changed from <code>[data-terra-dev-site-content] *:first-child</code> to <code>[data-terra-test-content] *:first-child</code>. This selector is used as the default content region for capturing screenshots. This change should not affect most teams. For teams that are affected a custom selector can be provided using <a href="https://engineering.cerner.com/terra-ui/dev_tools/cerner/terra-functional-testing/wdio-services/terra-service#selector">service options</a>.</p>\n<h2 id="new-features"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#new-features"><span class="icon icon-link" /></a>New Features</h2><h3 id="accessibility-reporter"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#accessibility-reporter"><span class="icon icon-link" /></a>Accessibility Reporter</h3><p>A custom WebDriverIO reporter has been created to facilitate monitoring accessibility violations and reporting them upon the completion of the test run. The goal of this reporter is to allow us to more frequently upgrade our version of axe-core without as many breaking changes. When axe adds new rules those rules can be marked as warnings and the accessibility reporter will report them to the terminal without failing as a violation. Please monitor your terminal output to stay proactive on accessibility warnings.</p>\n<h3 id="terra-cli"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#terra-cli"><span class="icon icon-link" /></a>Terra CLI</h3><p>Our command line interface has been transitioned to <a href="https://engineering.cerner.com/terra-ui/dev_tools/cerner/terra-cli/about">Terra CLI</a> to create a uniform experience across our scripts. All new commands are integrated plugins for the terra-cli. Command options are constructed using <a href="https://github.com/yargs/yargs">yargs</a>;</p>\n<p>As part of this upgrade teams will be updating the scripts used to invoke wdio to use the terra-cli commands. The <code>terra wdio</code> script will invoke the test runner.</p>\n<p>Note: The terra cli array parameters have a different syntax. <a href="https://github.com/yargs/yargs/blob/master/docs/api.md#array">Array</a> items are now delimited by a space.</p>\n<pre><code class="codeblock language-diff">// package.json\n{\n<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> "scripts": {\n</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    "test:wdio": "wdio"\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "test:wdio": "terra wdio"\n</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    "test:wdio:local": "tt-wdio --gridUrl=\'grid.test.example.com\' --locales=[\'de\',\'en-AU\'] --browsers=[\'chrome\',\'firefox\',\'ie\']"\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "test:wdio:local": "terra wdio --gridUrl grid.test.example.com --locales de en-AU --browsers chrome firefox ie"\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }\n</span></span>}</code></pre>\n<h3 id="auto-update-screenshots"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#auto-update-screenshots"><span class="icon icon-link" /></a>Auto Update Screenshots</h3><p>A CLI option has been added to auto-update reference screenshots during the test run. When enabled all screenshots generated during the test run will automatically overwrite the existing reference screenshot. Be sure to manually validate screenshot updates when using this feature.</p>\n<p>Via the Terra CLI:</p>\n<pre><code class="codeblock language-sh">terra wdio --updateScreenshots\n\n# -u is a shortcut for the same command\nterra wdio -u</code></pre>\n<h3 id="vpn-support"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#vpn-support"><span class="icon icon-link" /></a>VPN Support</h3><p>We&#39;ve added support to automatically detect the VPN IP address. It is no longer necessary to manually specify the <code>WDIO_EXTERNAL_HOST</code> when running wdio. These changes were tested successfully on Mac OS Catalina. Results may vary when running on different platforms and operating systems. It&#39;s not perfect and we&#39;ll make tweaks as necessary. If this is not working for you let us know. Be sure to specify the operating system and platform you&#39;re developing on.</p>\n<h2 id="how-to-upgrade"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#how-to-upgrade"><span class="icon icon-link" /></a>How to Upgrade</h2><p>There are a few prerequisites to get started. We&#39;ll be removing <code>terra-toolkit</code> as a dependency later in this guide. Removing <code>terra-toolkit</code> is going to impact starting the local development site and webpack configurations. The first step of this transition will be to upgrade to <a href="https://engineering.cerner.com/terra-ui/dev_tools/cerner/webpack-config-terra/about">@cerner/webpack-config-terra</a>.</p>\n<h3 id="upgrading-webpack"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#upgrading-webpack"><span class="icon icon-link" /></a>Upgrading Webpack</h3><p>If you are already using @cerner/webpack-config-terra ^1.0.0 you can skip this section.</p>\n<p>A complete upgrade guide can be found <a href="https://engineering.cerner.com/terra-ui/dev_tools/cerner/webpack-config-terra/upgrade-guide">here</a>. Webpack can be upgraded separately from terra-functional-testing. This change does not need to be bundled with test updates, but it does need to happen before the test updates.</p>\n<p>Install @cerner/webpack-config-terra, @cerner/terra-aggregate-translations, and postcss ^8.2.1 (a required peer dependency of webpack-config-terra):</p>\n<pre><code class="codeblock language-sh">npm install --save-dev @cerner/webpack-config-terra @cerner/terra-aggregate-translations postcss@8.2.1</code></pre>\n<p>If your project utilizes the <code>tt-serve-static</code> bin command go ahead and install <a href="https://engineering.cerner.com/terra-ui/dev_tools/cerner/terra-cli/about">terra-cli</a> as you&#39;ll need it to upgrade the static asset utilities:</p>\n<pre><code class="codeblock language-sh">npm install --save-dev @cerner/terra-cli</code></pre>\n<p>Update any references to the old webpack configuration:</p>\n<pre><code class="codeblock language-diff">// webpack.config.js\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> const webpackConfig = require(\'terra-dev-site/config/webpack/webpack.config\');\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const webpackConfig = require(\'@cerner/webpack-config-terra\');</span></span></code></pre>\n<p>Update any references to the old terra-aggregate-translations:</p>\n<pre><code class="codeblock language-diff">// jestGlobalSetup.js\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> const aggregateTranslations = require(\'terra-aggregate-translations\');\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const aggregateTranslations = require(\'@cerner/terra-aggregate-translations\');</span></span></code></pre>\n<p>Update any scripts in the package.json to use webpack-dev-server. Use terra-cli for any static sites. Remove <code>terra-aggregate-translations</code> if installed:</p>\n<pre><code class="codeblock language-diff">// package.json\n{\n<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> "scripts": {\n</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    "start": "tt-serve",\n</span><span class="token prefix deleted">-</span><span class="token line">    "start-prod": "tt-serve --env.disableHotReloading -p",\n</span><span class="token prefix deleted">-</span><span class="token line">    "start-static": "npm run pack &amp;&amp; tt-serve-static",\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "start": "webpack-dev-server",\n</span><span class="token prefix inserted">+</span><span class="token line">    "start-prod": "webpack-dev-server --env.disableHotReloading -p",\n</span><span class="token prefix inserted">+</span><span class="token line">    "start-static": "npm run pack &amp;&amp; terra express-server --site ./build",\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },\n</span><span class="token prefix unchanged"> </span><span class="token line"> "devDependencies": {\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   "@cerner/terra-aggregate-translations": "^2.0.1",\n</span><span class="token prefix inserted">+</span><span class="token line">   "@cerner/terra-cli": "^1.3.0",\n</span><span class="token prefix inserted">+</span><span class="token line">   "@cerner/webpack-config-terra": "^1.2.0",\n</span><span class="token prefix inserted">+</span><span class="token line">   "postcss": "^8.2.1",\n</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   "terra-aggregate-translations": "^1.0.0"\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }\n</span></span>}</code></pre>\n<p>At this point it is recommended to do a clean install prior to testing each of the scripts. If you have the script go ahead and run <code>npm run clean:install</code>. Alternatively ensure that the old node_modules directory is deleted and reinstall all dependencies.</p>\n<pre><code class="codeblock language-sh">npm run clean:install</code></pre>\n<p>Verify each of the scripts are working as intended:</p>\n<pre><code class="codeblock language-sh">npm run start\n\nnpm run start-prod\n\nnpm run start-static</code></pre>\n<p>Note: If you don&#39;t have some of these commands it is not necessary to add them. Just ensure the commands you do have are working as expected. All of the <code>tt-serve</code> commands should be updated to use webpack-dev-server or the terra express server</p>\n<h3 id="upgrading-eslint-config-terra"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#upgrading-eslint-config-terra"><span class="icon icon-link" /></a>Upgrading ESlint Config Terra</h3><p>If you are already using @cerner/eslint-config-terra ^5.0.0 you can skip this section.</p>\n<p>Upgrading <code>@cerner/eslint-config-terra</code> is optional, but recommended. WebDriverIO v6 syntax requires using the <code>$</code> global which has been <a href="https://github.com/cerner/terra-toolkit/pull/548">added</a> to the eslint config. If you choose not to upgrade eslint-config-terra at this time you will need to add the global declaration manually in each spec file.</p>\n<p>Adding the global manually to each spec file is only necessary if you are not upgrading to @cerner/eslint-config-terra ^5.0.0:</p>\n<pre><code class="codeblock language-js"><span class="token comment">/* global $ */</span></code></pre>\n<p>A complete upgrade guide can be found <a href="https://github.com/cerner/terra-toolkit/blob/main/packages/eslint-config-terra/UpgradeGuide.md#eslint-config-terra-upgrade-guide">here</a>.</p>\n<p>Install @cerner/eslint-config-terra:</p>\n<pre><code class="codeblock language-sh">npm install --save-dev @cerner/eslint-config-terra</code></pre>\n<p>Remove the old <code>eslint-config-terra</code> and extend <code>@cerner/terra</code> from the <code>eslintConfig</code> key:</p>\n<pre><code class="codeblock language-diff">// package.json\n{\n<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> "eslintConfig": {\n</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   "extends": "terra",\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   "extends": "@cerner/terra",\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },\n</span><span class="token prefix unchanged"> </span><span class="token line"> "devDependencies": {\n</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    "eslint-config-terra": "^3.3.0",\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "@cerner/eslint-config-terra": "^5.0.0",\n</span><span class="token prefix inserted">+</span><span class="token line">    "eslint": "^7.0.0" // Upgrade ESlint to v7.\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }\n</span></span>}</code></pre>\n<p>At this point it is recommended to do a clean install prior to running lint. If you have the script go ahead and run <code>npm run clean:install</code>. Alternatively ensure that the old node_modules directory is deleted and reinstall all dependencies.</p>\n<pre><code class="codeblock language-sh">npm run clean:install</code></pre>\n<p>Run eslint and resolve any of the new violations introduced by the new version of ESLint plugins transitively introduced.</p>\n<pre><code class="codeblock language-sh">npm run lint</code></pre>\n<h3 id="installing-terra-functional-testing"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#installing-terra-functional-testing"><span class="icon icon-link" /></a>Installing Terra Functional Testing</h3><p>After upgrading webpack and eslint your project is ready to start the migration to @cerner/terra-functional-testing. Before getting started make sure you&#39;re prepared to work through the entire uplift. We&#39;ll be removing the dependency on terra-toolkit. The implications are that the entire test suite needs to be uplifted. Our recommendation will be to split up the work and go through each spec file one by one. Enabling only the tests you are currently uplifting and disabling the others.</p>\n<p>Install @cerner/terra-functional-testing and @cerner/terra-cli:</p>\n<pre><code class="codeblock language-sh">npm install --save-dev @cerner/terra-functional-testing @cerner/terra-cli</code></pre>\n<p>Remove terra-toolkit from the package.json:</p>\n<pre><code class="codeblock language-diff">// package.json\n{\n<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> "devDependencies": {\n</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   "terra-toolkit": "^6.0.0",\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   "@cerner/terra-cli": "^1.0.0",\n</span><span class="token prefix inserted">+</span><span class="token line">   "@cerner/terra-functional-testing": "^1.0.0"\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }\n</span></span>}</code></pre>\n<p>Update any references to the previous <code>wdio.conf.js</code>:</p>\n<pre><code class="codeblock language-diff">// wdio.conf.js\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> const wdioConfig = require(\'terra-toolkit/config/wdio/wdio.conf\');\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const { config } = require(\'@cerner/terra-functional-testing/lib/config/wdio.conf\');\n</span></span>\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> module.exports = wdioConfig;\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> exports.config = config;</span></span></code></pre>\n<p>Update scripts to use the Terra CLI:</p>\n<p>Note: The terra cli array parameters have a different syntax.</p>\n<pre><code class="codeblock language-diff">// package.json\n{\n<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> "scripts": {\n</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    "test:wdio": "wdio"\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "test:wdio": "terra wdio"\n</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    "test:wdio:local": "tt-wdio --gridUrl=\'grid.test.example.com\' --locales=[\'de\',\'en-AU\'] --browsers=[\'chrome\',\'firefox\',\'ie\']"\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "test:wdio:local": "terra wdio --gridUrl grid.test.example.com --locales de en-AU --browsers chrome firefox ie"\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }\n</span></span>}</code></pre>\n<p>A list of the test runner CLI options can be found <a href="https://engineering.cerner.com/terra-ui/dev_tools/cerner/terra-functional-testing/about#test-runner">here</a>.</p>\n<p>At this point it is recommended to do a clean install to remove stale installations of terra-toolkit. If you have the script go ahead and run <code>npm run clean:install</code>. Alternatively ensure that the old node_modules directory is deleted and reinstall all dependencies.</p>\n<pre><code class="codeblock language-sh">npm run clean:install</code></pre>\n<h3 id="upgrading-tests"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#upgrading-tests"><span class="icon icon-link" /></a>Upgrading Tests</h3><p>From here you are ready to start upgrading each of the spec files within your project. We recommend you uplifting each spec one by one by modifying the <code>wdio.config.js</code>. We used this strategy ourselves during our uplift and we think it helps.</p>\n<p>Choose a spec file to uplift and limit the test run to only that file.</p>\n<pre><code class="codeblock language-js"><span class="token comment">// wdio.conf.js</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span> config <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'@cerner/terra-functional-testing/lib/config/wdio.conf\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nconfig<span class="token punctuation">.</span>specs <span class="token operator">=</span> <span class="token punctuation">[</span>\n  <span class="token string">\'/tests/wdio/path/example-spec\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n\nexports<span class="token punctuation">.</span>config <span class="token operator">=</span> config<span class="token punctuation">;</span></code></pre>\n<p>Here are some resources you&#39;ll want to bookmark as you work through each spec file.</p>\n<ul>\n<li><a href="http://v4.webdriver.io/api.html">WebDriverIO v4 API</a></li>\n<li><a href="https://v6.webdriver.io/docs/api.html">WebDriverIO v6 API</a></li>\n</ul>\n<p>Work through the spec file and update the deprecated browser commands. Read through the <a href="#webdriverio-v4-to-v6">WebDriverIO breaking changes</a> section above for more information.</p>\n<p>Here are a few of the most common scenarios we encountered:</p>\n<pre><code class="codeblock language-diff">// Clicks\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> browser.click(\'#element\');\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> $(\'#element\').click();\n</span></span>\n// Set Value\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> browser.setValue(\'input\', \'value\');\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> $(\'input\').setValue(\'value\');\n</span></span>\n// Add Value\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> browser.addValue(\'input\', \'value\');\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> $(\'input\').addValue(\'value\');\n</span></span>\n// Wait For Visible\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> browser.waitForVisible(\'#element\');\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> $(\'#element\').waitForDisplayed();\n</span></span>\n// Move To\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> browser.moveToObject(\'#element\', 0, 10);\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> $(\'#element\').moveTo({ xOffset: 0, yOffset: 10 });</span></span></code></pre>\n<p>Update any chai assertions to expect assertions. Read through the <a href="#assertion-framework">assertion breaking changes</a> section above for more information.</p>\n<p>A few common changes look something like this:</p>\n<pre><code class="codeblock language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> expect(true).to.be.true; // Chai assertion\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> expect(true).toBe(true); // Expect/Jest assertion.\n</span></span>\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> expect(true).to.be.false; // Chai assertion\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> expect(true).toBe(false); // Expect/Jest assertion.\n</span></span>\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> expect(1).to.equal(1); // Chai assertion\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> expect(1).toEqual(1); // Expect/Jest assertion.</span></span></code></pre>\n<p>Ensure each <code>Terra.validates.element</code> and <code>Terra.validates.screenshot</code> is provided a unique name. Read through the <a href="#screenshots">screenshots</a> section above for more information.</p>\n<pre><code class="codeblock language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'should click and validate the element\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">\'#element\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  Terra<span class="token punctuation">.</span>validates<span class="token punctuation">.</span><span class="token function">element</span><span class="token punctuation">(</span><span class="token string">\'screenshot name\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  A unique screenshot name must be provided or the command will throw an error.</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<p>Delete all screenshots associated to that spec file and initiate the test runner to regenerate screenshots. Resolve any errors that are thrown. Ensure every test generating a screenshot provides a unique screenshot name. Once the test run is successful move on to the next spec file and repeat the process.</p>\n<p>The following example will throw a mismatch error because two screenshots are being generated with the same name.</p>\n<pre><code class="codeblock language-js"><span class="token comment">// example-spec.js</span>\n\n<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'should click and validate the element\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">\'#element-1\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  Terra<span class="token punctuation">.</span>validates<span class="token punctuation">.</span><span class="token function">element</span><span class="token punctuation">(</span><span class="token string">\'screenshot name\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">\'should click and validate the element\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">\'#element-2\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  Terra<span class="token punctuation">.</span>validates<span class="token punctuation">.</span><span class="token function">element</span><span class="token punctuation">(</span><span class="token string">\'screenshot name\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  Will throw an error because a previous screenshot was generated with the same name.</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n<h2 id="the-future-webdriverio-v7-node-12"><a class="anchor" aria-hidden="true" tabIndex="-1" href="#the-future-webdriverio-v7-node-12"><span class="icon icon-link" /></a>The Future - WebDriverIO v7 - Node 12</h2><p>WebDriverIO v7 was released on <a href="https://webdriver.io/blog/2021/02/09/webdriverio-v7-released">February 9th, 2021</a> and is on our radar. We&#39;ll be focusing on getting teams upgraded onto WebDriverIO v6 and node &gt;= 10 as a stepping stone before releasing an upgrade to WebDriverIO v7. The changes from WebDriverIO v6 to v7 drop support for node 10 and appear to largely only impact typescript declarations. We&#39;ll investigate the breaking changes and work necessary for upgrading. We plan to release an upgrade in the near future pending the investigation and transition strategy for node &gt;= 12.</p>\n'}})}}}]);